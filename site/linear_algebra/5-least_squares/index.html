
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.9">
    
    
      
        <title>Ax ≈ b - Machine Learning Foundations</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.120efc48.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.9647289d.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ax-b" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Machine Learning Foundations" class="md-header__button md-logo" aria-label="Machine Learning Foundations" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Machine Learning Foundations
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Ax ≈ b
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Machine Learning Foundations" class="md-nav__button md-logo" aria-label="Machine Learning Foundations" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    Machine Learning Foundations
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          Linear Algebra
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Linear Algebra" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Linear Algebra
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0-linear_algebra/" class="md-nav__link">
        Linear Algebra for ML
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1-ml_problem/" class="md-nav__link">
        ML problem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../2-linear_model/" class="md-nav__link">
        Linear Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../3-system_1/" class="md-nav__link">
        Ax = 0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4-system_2/" class="md-nav__link">
        Ax = b
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Ax ≈ b
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Ax ≈ b
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#approximation" class="md-nav__link">
    Approximation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-function" class="md-nav__link">
    Objective function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#normal-equations" class="md-nav__link">
    Normal Equations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#least-squares-problem" class="md-nav__link">
    Least Squares Problem
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../6-best_fit/" class="md-nav__link">
        Best Fit Hyperplane
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../7-projections/" class="md-nav__link">
        Projections
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Appendix
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Appendix" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Appendix
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/0-gradients/" class="md-nav__link">
        Gradients
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#approximation" class="md-nav__link">
    Approximation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective-function" class="md-nav__link">
    Objective function
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#normal-equations" class="md-nav__link">
    Normal Equations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#least-squares-problem" class="md-nav__link">
    Least Squares Problem
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="ax-b">Ax ≈ b<a class="headerlink" href="#ax-b" title="Permanent link">&para;</a></h1>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How do we solve for <span class="arithmatex">\(x\)</span> in <span class="arithmatex">\(Ax \approx b\)</span>?</p>
</div>
<h2 id="approximation">Approximation<a class="headerlink" href="#approximation" title="Permanent link">&para;</a></h2>
<p>So far we have seen the well behaved case of <span class="arithmatex">\(Ax = b\)</span>. What if <span class="arithmatex">\(b\)</span> is not in the column space of <span class="arithmatex">\(A\)</span>? Then <span class="arithmatex">\(Ax \neq b\)</span>. This is by far the most interesting and relevant scenario from the perspective of the linear regression problem. Recall that we are trying to estimate a weight vector <span class="arithmatex">\(x\)</span>, given the labeled dataset <span class="arithmatex">\((A, b)\)</span>. The relationship between inputs and outputs is assumed to be linear. But the real world doesn't behave exactly like we want it to. There are going to be obvious deviations from our ideal assumptions. In other words, our models can never be an entirely accurate representation of reality.</p>
<p>This is a typical scenario observed in engineering and the sciences. We don't abandon the problem because it doesn't admit an exact solution. Instead, we turn to a powerful weapon in our armoury: approximations. Can we find a <span class="arithmatex">\(\hat{x}\)</span> such that <span class="arithmatex">\(A \hat{x} \approx b\)</span>? What do we mean by the symbol <span class="arithmatex">\(\approx\)</span> here? We are dealing with two vectors on either side of the symbol. Let us first understand what the symbol means when we have scalars.</p>
<p>Let us look at the following statements:</p>
<ul>
<li><span class="arithmatex">\(1.234 \approx 1\)</span></li>
<li><span class="arithmatex">\(1.234 \approx 1.2\)</span></li>
<li><span class="arithmatex">\(1.234 \approx 1.23\)</span></li>
</ul>
<p>These are three approximations. From experience, we know that the second approximation is better than the first, the third better than the second. If we plot these points on a real line, the goodness of an approximation can be interpreted using the distance between the original point and its approximation: smaller the distance, better the approximation.</p>
<p>This very idea is extended to an <span class="arithmatex">\(n\)</span> dimensional vector space. If <span class="arithmatex">\(b\)</span> and <span class="arithmatex">\(\hat{b}\)</span> are two vectors in <span class="arithmatex">\(\mathbb{R}^m\)</span>, then the distance <span class="arithmatex">\(d\)</span> between them is a measure of the goodness of the approximation. To avoid taking square roots, we write down the expression for <span class="arithmatex">\(d^2\)</span>:</p>
<div class="arithmatex">\[
d^2 = ||\hat{b} - b||^2 = (\hat{b}_1 - b_1)^2 + \cdots + (\hat{b}_m - b_m)^2
\]</div>
<p>So, the key to solving the problem <span class="arithmatex">\(Ax \approx b\)</span>, is to find a vector <span class="arithmatex">\(\hat{x}\)</span> such that <span class="arithmatex">\(A\hat{x}\)</span> is as close to <span class="arithmatex">\(b\)</span> as possible. This can be framed as an optimization problem:</p>
<div class="arithmatex">\[
\hat{x} = \arg \min \limits_{x} ||Ax - b||^2
\]</div>
<p>If you are seeing <span class="arithmatex">\(\arg \min\)</span> for the first time, think about it like a function (in the programming sense):</p>
<ul>
<li>Find the value the minimizes the expression</li>
<li>Return this value to the user</li>
</ul>
<h2 id="objective-function">Objective function<a class="headerlink" href="#objective-function" title="Permanent link">&para;</a></h2>
<p>Let us go ahead and solve the minimization problem.</p>
<div class="arithmatex">\[
\min \limits_{x} ||Ax - b||^2
\]</div>
<p>Let us call the expression to be minimized, <span class="arithmatex">\(E\)</span>, this is also called the objective function of the optimization problem. It can be simplified as follows:</p>
<div class="arithmatex">\[
\begin{align}
E &amp;= ||Ax - b||^2\\\\
&amp;= (Ax - b)^T(Ax - b)\\\\
\end{align}
\]</div>
<h2 id="normal-equations">Normal Equations<a class="headerlink" href="#normal-equations" title="Permanent link">&para;</a></h2>
<p>We now follow the usual procedure of finding the minima of a function. Take the derivatives and set them to zero. Since we are dealing with a multivariable function, we have to consider all the partial derivatives. The vector of such partial derivatives is called the gradient.</p>
<div class="arithmatex">\[
\nabla E = \begin{bmatrix}
\cfrac{\partial E}{\partial x_1}\\
\vdots\\
\cfrac{\partial E}{\partial x_n}
\end{bmatrix}
\]</div>
<p>Let us now compute the gradient and set it to zero. If you want a detailed mathematical explanation of how the gradient is computed, refer to the <a href="../../appendix/0-gradients/">appendix</a>:</p>
<div class="arithmatex">\[
\nabla E = 2(A^TA)x - 2A^Tb = 0
\]</div>
<p>This gives us the following equation:</p>
<p>$$
(A^TA) x = A^Tb
$$
This system is called the <strong>normal equations</strong>. If the matrix <span class="arithmatex">\(A^TA\)</span> is invertible, then we have the following solution:</p>
<div class="arithmatex">\[
\hat{x} = (A^TA)^{-1} A^Tb
\]</div>
<p>We still don't know if this is corresponds to a minima. Rest assured that this is indeed a minima. But we won't take up the proof now. The other worrying part is what happens if the matrix <span class="arithmatex">\(A^TA\)</span> is singular or non-invertible. This is also something that we skip for the time being.</p>
<h2 id="least-squares-problem">Least Squares Problem<a class="headerlink" href="#least-squares-problem" title="Permanent link">&para;</a></h2>
<p>This is often called the least squares problem. To see why this name is used, let us revisit the objective function:</p>
<div class="arithmatex">\[
E = (Ax - b)^T (Ax - b)
\]</div>
<p>Since <span class="arithmatex">\(Ax\)</span> is an approximation of <span class="arithmatex">\(b\)</span>, <span class="arithmatex">\(e = Ax - b\)</span> can be seen as an error vector. So:</p>
<div class="arithmatex">\[
E = e^T e = e_1^2 + \cdots + e_m^2
\]</div>
<p>From a ML standpoint, recall the housing dataset with which we started. <span class="arithmatex">\(e_i\)</span> is the difference between the actual selling price of the <span class="arithmatex">\(i^{th}\)</span> house and its predicted selling price as given by our linear model. In a sense, we are justified in calling <span class="arithmatex">\(e\)</span> the error vector. We are minimizing the sum of the squared errors, hence "least squares". <span class="arithmatex">\(\hat{x}\)</span> is that weight vector for the linear model which will give us the best possible fit. In the next few units, we shall try to understand the least squares problem from the lens of geometry.</p>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../4-system_2/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Ax = b" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Ax = b
            </div>
          </div>
        </a>
      
      
        
        <a href="../6-best_fit/" class="md-footer__link md-footer__link--next" aria-label="Next: Best Fit Hyperplane" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Best Fit Hyperplane
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6e54b5cd.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>