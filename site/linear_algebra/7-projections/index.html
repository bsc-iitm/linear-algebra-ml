
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.13">
    
    
      
        <title>Projections - Machine Learning Foundations</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e411adfe.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cc9b2e1e.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#projections" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Machine Learning Foundations" class="md-header__button md-logo" aria-label="Machine Learning Foundations" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Machine Learning Foundations
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Projections
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Machine Learning Foundations" class="md-nav__button md-logo" aria-label="Machine Learning Foundations" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    Machine Learning Foundations
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../contribute/" class="md-nav__link">
        Contribute
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Linear Algebra
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Linear Algebra" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Linear Algebra
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../0-linear_algebra/" class="md-nav__link">
        Linear Algebra for ML
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1-ml_problem/" class="md-nav__link">
        ML problem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../2-linear_model/" class="md-nav__link">
        Linear Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../3-system_1/" class="md-nav__link">
        Ax = 0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4-system_2/" class="md-nav__link">
        Ax = b
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../5-least_squares/" class="md-nav__link">
        Ax â‰ˆ b
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../6-best_fit/" class="md-nav__link">
        Best Fit Hyperplane
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Projections
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Projections
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setting" class="md-nav__link">
    Setting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#back-to-column-space" class="md-nav__link">
    Back to Column space
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#projections-2-dimensions" class="md-nav__link">
    Projections: 2-dimensions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#back-to-normal-equations" class="md-nav__link">
    Back to Normal Equations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#projections-m-dimensions" class="md-nav__link">
    Projections: m-dimensions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../8-eigenvalues.md" class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Appendix
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Appendix" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Appendix
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/0-gradients/" class="md-nav__link">
        Gradients
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/1-cauchy_schwarz/" class="md-nav__link">
        Cauchy-Schwarz Inequality
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setting" class="md-nav__link">
    Setting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#back-to-column-space" class="md-nav__link">
    Back to Column space
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#projections-2-dimensions" class="md-nav__link">
    Projections: 2-dimensions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#back-to-normal-equations" class="md-nav__link">
    Back to Normal Equations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#projections-m-dimensions" class="md-nav__link">
    Projections: m-dimensions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="projections">Projections<a class="headerlink" href="#projections" title="Permanent link">&para;</a></h1>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Geometrically, what is the relationship between the approximation <span class="arithmatex">\(A \hat{x}\)</span> and the vector <span class="arithmatex">\(b\)</span>?</p>
</div>
<h2 id="setting">Setting<a class="headerlink" href="#setting" title="Permanent link">&para;</a></h2>
<p>Recall that we are trying to solve the following:
$$
Ax \approx b
$$
The best approximation is given by the solution to this equation:</p>
<div class="arithmatex">\[
(A^TA)\hat{x} = A^Tb
\]</div>
<p><span class="arithmatex">\(A\hat{x}\)</span> is therefore the best approximation for <span class="arithmatex">\(b\)</span>. Now, how are these two vectors related? Specifically, note that both vectors reside in <span class="arithmatex">\(\mathbb{R}^{m}\)</span>. To keep things simple, let us return to our favourite haunt, <span class="arithmatex">\(\mathbb{R}^2\)</span>, with the following configuration:</p>
<div class="arithmatex">\[
A = \begin{bmatrix}
2 &amp; 6\\
1 &amp; 3
\end{bmatrix}, b = \begin{bmatrix}
3\\
4
\end{bmatrix}
\]</div>
<h2 id="back-to-column-space">Back to Column space<a class="headerlink" href="#back-to-column-space" title="Permanent link">&para;</a></h2>
<p>We look for an approximation only when <span class="arithmatex">\(b\)</span> does not lie in the column space of <span class="arithmatex">\(A\)</span>. So, first, we see what the column space is:</p>
<div class="arithmatex">\[
C(A) = \text{span}\left( \left\{ \begin{bmatrix}2\\1\end{bmatrix} \right\} \right)
\]</div>
<p>The second column of <span class="arithmatex">\(A\)</span> is just three times the first column. The rank of the matrix is <span class="arithmatex">\(1\)</span>. The column space of <span class="arithmatex">\(A\)</span> is a one-dimensional subspace of <span class="arithmatex">\(\mathbb{R}^2\)</span> . Geometrically, what does this mean?</p>
<p><img alt="" src="../../assets/images/img_005.svg" width="1000" /></p>
<p>The column space is a line passing through the origin and the point <span class="arithmatex">\((2, 1)\)</span>. Clearly, the vector <span class="arithmatex">\(b\)</span> does not lie in the column space of <span class="arithmatex">\(A\)</span>. So, we are justified in looking for an approximation.</p>
<h2 id="projections-2-dimensions">Projections: 2-dimensions<a class="headerlink" href="#projections-2-dimensions" title="Permanent link">&para;</a></h2>
<p>The key idea to remember is that the approximation is going to lie in the column space of <span class="arithmatex">\(A\)</span>. What vector in <span class="arithmatex">\(C(A)\)</span> is closest to to <span class="arithmatex">\(b\)</span>?  First up, what do we mean by closest? Recall that the distance between the two vectors is our measure of distance. In our 2D case, this is nothing but the distance between the point <span class="arithmatex">\(b\)</span> and some point on the line <span class="arithmatex">\(C(A)\)</span>. The point on the line which is going to have the shortest distance is the projection of <span class="arithmatex">\(b\)</span> onto the line! Why is that the case? Among all line segments from a point to a line, the perpendicular to it is the shortest.</p>
<p><img alt="" src="../../assets/images/img_006.svg" width="1000" /></p>
<p>Geometric intuition therefore suggests that <span class="arithmatex">\(A\hat{x} = \begin{bmatrix}4\\2\end{bmatrix}\)</span>. </p>
<h2 id="back-to-normal-equations">Back to Normal Equations<a class="headerlink" href="#back-to-normal-equations" title="Permanent link">&para;</a></h2>
<p>Let us see if algebra agrees with geometry:</p>
<div class="arithmatex">\[
\begin{aligned}
(A^TA)\hat{x} &amp;= A^Tb\\\\
\begin{bmatrix}
2 &amp; 1\\
6 &amp; 3
\end{bmatrix} \begin{bmatrix}
2 &amp; 6\\
1 &amp; 3
\end{bmatrix} \begin{bmatrix}
\hat{x}_1\\
\hat{x}_2
\end{bmatrix} &amp;= \begin{bmatrix}
2 &amp; 1\\
6 &amp; 3
\end{bmatrix}\begin{bmatrix}
3\\
4
\end{bmatrix}\\\\
\begin{bmatrix}
5 &amp; 15\\
15 &amp; 45
\end{bmatrix} \begin{bmatrix}
\hat{x}_1\\
\hat{x}_2
\end{bmatrix} &amp;= \begin{bmatrix}
10\\
30
\end{bmatrix}\\\\
\begin{bmatrix}
1 &amp; 3\\
1 &amp; 3
\end{bmatrix} \begin{bmatrix}
\hat{x}_1\\
\hat{x}_2
\end{bmatrix} &amp;= \begin{bmatrix}
2\\
2
\end{bmatrix}\\
\end{aligned}
\]</div>
<p>We see that <span class="arithmatex">\(A^TA\)</span> is singular. But thankfully, the system is solvable. One such solution is:</p>
<div class="arithmatex">\[
\hat{x} = \begin{bmatrix}
-1\\
1
\end{bmatrix}
\]</div>
<p>Therefore, the approximation is:</p>
<div class="arithmatex">\[
A\hat{x} = \begin{bmatrix}
2 &amp; 6\\
1 &amp; 3
\end{bmatrix} \begin{bmatrix}
-1\\
1
\end{bmatrix} = \begin{bmatrix}
4\\
2
\end{bmatrix}
\]</div>
<p>Algebra does agree with geometry!</p>
<h2 id="projections-m-dimensions">Projections: m-dimensions<a class="headerlink" href="#projections-m-dimensions" title="Permanent link">&para;</a></h2>
<p>The main takeaway from the 2D case is this: the vector closest to <span class="arithmatex">\(b\)</span> in the column space of <span class="arithmatex">\(A\)</span> is its projection onto the column space of <span class="arithmatex">\(A\)</span>. This can be extended to any higher dimensional space. First, we note that for a projection, the error vector is orthogonal to the column space of <span class="arithmatex">\(A\)</span>:</p>
<p><img alt="" src="../../assets/images/img_007.svg" width="1000" /></p>
<p>The error vector <span class="arithmatex">\(e\)</span> is:
$$
e = b - A\hat{x}
$$
This is orthogonal to the column space of <span class="arithmatex">\(A\)</span>. This is the same as saying that it is orthogonal to each column of <span class="arithmatex">\(A\)</span>. If we let <span class="arithmatex">\(A\)</span> be <span class="arithmatex">\([a_1, \cdots, a_n]\)</span>, where <span class="arithmatex">\(a_i\)</span> is the <span class="arithmatex">\(i^{th}\)</span> column of <span class="arithmatex">\(A\)</span>. Then for <span class="arithmatex">\(1 \leq i \leq n\)</span>:</p>
<p>$$
a_i^T e = 0
$$
This can be neatly expressed as:</p>
<div class="arithmatex">\[
A^Te=0
\]</div>
<p>So, the error vector is in the nullspace of <span class="arithmatex">\(A^T\)</span>! Replacing <span class="arithmatex">\(e = b - A\hat{x}\)</span>, we get:</p>
<p>$$
\begin{aligned}
A^T(b - A\hat{x}) &amp;= 0\
\implies (A^TA)\hat{x} = A^Tb
\end{aligned}
$$
The normal equations again! </p>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>If the parameters of the linear model obtained by solving the normal equations is <span class="arithmatex">\(\hat{x}\)</span>, then the vector <span class="arithmatex">\(A\hat{x}\)</span> is the projection of the vector <span class="arithmatex">\(b\)</span> onto the column space of <span class="arithmatex">\(A\)</span>.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../6-best_fit/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Best Fit Hyperplane" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Best Fit Hyperplane
            </div>
          </div>
        </a>
      
      
        
        <a href="../../appendix/0-gradients/" class="md-footer__link md-footer__link--next" aria-label="Next: Gradients" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Gradients
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ed9748b7.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>